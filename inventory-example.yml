####
#
#   MAKE A COPY OF THIS AND NAME IT `inventory.yaml` or `inventory.yml`. Update for your situation
#
####

# Primary server that can be used as a config or a worker, but is counted out just-in-case
# Represents all other physical machines in the cluster

# NOTE: These WILL be different based on the network availability. Configure each node

# control_plane_vip -- IP address that is addressable & available, not overlapping with other clusters, but not pre-allocated. This is created during the process
# ingress_vip: Must be in the Load Balancer pool for the cluster, same rules as control_plane_vip for availability
# load_balancer_pool_cidr: IP addresses for the LoadBalancers (bundled mode) can attach to, same rules as control_plane_vip
# control_plane_ip: -- different than the control_plane_vip, this is the IP of the box you are installing on

# NOTE: In this file, only 9 LBs are allocated per cluster, with 1 taken for Ingress

# Comment out (or remove) any inventory that is not available

all:
  vars:
    google_project_id: "{{ lookup('env', 'PROJECT_ID') }}"
    google_region: "{{ lookup('env', 'REGION') | default('us-central1', True) }}"
    google_zone: "{{ lookup('env', 'ZONE') | default('us-central1-a', True) }}"
    # SCM (GitLab, GitHub access token)
    scm_token_user: "{{ lookup('env', 'SCM_TOKEN_USER') }}"
    scm_token_token: "{{ lookup('env', 'SCM_TOKEN_TOKEN') }}"

    # GCS bucket containing VMs
    gcs_bucket_guest_vm: "anthos-gcs-bucket-with-iso-images"
    # VM ISO for guest OS
    vm_guest_image: "windows-server-2016-eval-en-us.iso"

    franchises: [
      {
        franchise_number: "1",
        git_creds_gcp_secret_name: "franchise-1-git-creds",
        franchise_name: "ACME",
        stores: [
          "nuc-1",
          "nuc-2"
        ]
      },
      {
        franchise_name: "Innotec",
        franchise_number: "2",
        git_creds_gcp_secret_name: "franchise-2-git-creds",
        stores: [
          "nuc-3",
          "nuc-4"
        ]
      },
      {
        franchise_name: "Penatrode",
        franchise_number: "3",
        git_creds_gcp_secret_name: "franchise-3-git-creds",
        stores: [
          "nuc-5"
        ]
      }
    ]


workers:
  hosts:
    vars:
      shared_variable: "This is just a dummy message for all workers"
    nuc-1.lan:
      cluster_name: "nuc-1"
      franchise_number: "1"
      acm_cluster_name: "store-1-1"
      cluster_index: 0
      control_plane_ip: "{{ lookup('dig', 'nuc-1.lan') }}"
      control_plane_vip: "192.168.2.100"
      ingress_vip: "192.168.2.101"
      load_balancer_pool_cidr: "192.168.2.101-192.168.2.109"
    nuc-2.lan:
      cluster_name: "nuc-2"
      franchise_number: "1"
      acm_cluster_name: "store-1-2"
      cluster_index: 1
      control_plane_ip: "{{ lookup('dig', 'nuc-2.lan') }}"
      control_plane_vip: "192.168.2.110"
      ingress_vip: "192.168.2.111"
      load_balancer_pool_cidr: "192.168.2.111-192.168.2.119"
    nuc-3.lan:
      cluster_name: "nuc-3"
      franchise_number: "2"
      acm_cluster_name: "store-2-1"
      cluster_index: 2
      control_plane_ip: "{{ lookup('dig', 'nuc-3.lan') }}"
      control_plane_vip: "192.168.2.120"
      ingress_vip: "192.168.2.121"
      load_balancer_pool_cidr: "192.168.2.121-192.168.2.129"
    nuc-4.lan:
      cluster_name: "nuc-4"
      franchise_number: "2"
      acm_cluster_name: "store-2-2"
      cluster_index: 3
      control_plane_ip: "{{ lookup('dig', 'nuc-4.lan') }}"
      control_plane_vip: "192.168.2.130"
      ingress_vip: "192.168.2.131"
      load_balancer_pool_cidr: "192.168.2.131-192.168.2.139"
    nuc-5.lan:
      cluster_name: "nuc-5"
      franchise_number: "3"
      acm_cluster_name: "store-3-1"
      cluster_index: 4
      control_plane_ip: "{{ lookup('dig', 'nuc-5.lan') }}"
      control_plane_vip: "192.168.2.140"
      ingress_vip: "192.168.2.141"
      load_balancer_pool_cidr: "192.168.2.141-192.168.2.149"
