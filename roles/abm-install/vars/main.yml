---
# vars file for abm-install

# Folder to run installation out of
abm_install_folder: "/var/abm-install"
abm_workspace_folder: "{{ abm_install_folder }}/bmctl-workspace"

# Match with Google-Tools (by convention, not required, but good idea)
remote_gsa_key: "/var/keys"

kubeconfig_shared_root: "/var/kubeconfig"
kubeconfig_shared_location: "{{ kubeconfig_shared_root }}/kubeconfig"

# User that has sudo, password less SSH access to control_plane_ip
abm_install_user: "el-gato"

# Cluster Configuration
install_type: standalone
multi_network_enabled: true
enable_application_logging: true

# Skip preflight checks?
skip_preflight: false

# Cluster IP Ranges
pod_cidr: "100.127.0.0/16"
services_cidr: "192.168.30.0/23"

# Cluster Persistant Volumes (outside of overlay storage options)
local_pvc_mount: "/opt/pvc-disk"
local_share_pvc_mount: "/opt/localpv-share" # Default value

# Cluster runtime
container_runtime: "containerd" # docker or containerd

# Service Account Configuration
service_accounts: [
  {
    name: abm-gcr-agent,
    keyfile: abm-gcr-agent-creds.json,
    description: "ABM GCR Agent Account",
    roles: [
      "roles/storage.objectViewer"
    ]
  },
  {
    name: abm-gke-connect-agent,
    keyfile: abm-gke-connect-agent-creds.json,
    description: "ABM GKE Connect Agent Service Account",
    roles: [
      "roles/gkehub.connect"
    ]
  },
  {
    name: abm-gke-register-agent,
    keyfile: abm-gke-register-agent-creds.json,
    description: "ABM GKE Connect Register Account",
    roles: [
      "roles/gkehub.admin"
    ]
  },
  {
    name: abm-cloud-operations-agent,
    keyfile: abm-cloud-operations-agent-creds.json,
    description: "ABM Cloud Operations Service Account",
    roles: [
      "roles/logging.logWriter",
      "roles/monitoring.metricWriter",
      "roles/stackdriver.resourceMetadata.writer",
      "roles/monitoring.dashboardEditor"
    ]
  },
  {
    name: external-secrets-k8s,
    keyfile: external-secrets-k8s-creds.json,
    description: "External Secrets Service Account",
    roles: [
      "roles/secretmanager.secretAccessor",
      "roles/secretmanager.viewer"
    ]
  },
  {
    name: longhorn-cloud-storage,
    keyfile: longhorn-cloud-storage-creds.json,
    description: "Longhorn taking volume backups on cloud stoarge ",
    roles: [
      "roles/storage.objectAdmin"
    ]
  },
  {
    name: gateway-connect-agent,
    keyfile: gateway-connect-agent-creds.json,
    description: "Agent used for Gateway Connect",
    roles: [
      "roles/gkehub.gatewayAdmin",
      "roles/gkehub.viewer"
    ]
  }
]

longhorn_secret_name: "longhorn-cloud-storage-hmac"
